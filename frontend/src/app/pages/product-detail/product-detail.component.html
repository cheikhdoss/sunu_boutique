<div class="product-detail-container cinematic-product">
  <!-- Arri√®re-plan anim√© -->
  <div class="product-background">
    <div class="particle-field"></div>
    <div class="energy-waves"></div>
    <div class="holographic-grid"></div>
    <div class="ambient-lights"></div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-animation">
      <div class="loading-ring">
        <div class="loading-core">
          <mat-icon class="loading-icon">shopping_bag</mat-icon>
        </div>
      </div>
    </div>
    <p>Chargement du produit...</p>
  </div>

  <!-- Product Detail -->
  <div *ngIf="!loading && (product$ | async) as product" class="product-content">
    <!-- Navigation -->
    <nav class="product-navigation">
      <button class="nav-button back-button" (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
        <span>Retour aux produits</span>
        <div class="button-glow"></div>
      </button>
    </nav>

    <div class="product-showcase">
      <!-- Section Images -->
      <div class="product-gallery">
        <div class="gallery-container">
          <div class="main-image-wrapper">
            <div class="image-frame">
              <img [src]="getImageUrl(product.image)" 
                   [alt]="product.name"
                   class="product-image"
                   (error)="onImageError($event)"
                   (load)="onImageLoad()">
              
              <!-- Placeholder pour image indisponible -->
              <div class="image-placeholder" *ngIf="imageError">
                <div class="placeholder-animation">
                  <div class="placeholder-ring">
                    <mat-icon class="placeholder-icon">image_not_supported</mat-icon>
                  </div>
                </div>
                <div class="placeholder-content">
                  <h3>Image indisponible</h3>
                  <p>L'image de ce produit n'est pas disponible pour le moment</p>
                </div>
              </div>
              
              <!-- Badge de stock -->
              <div class="stock-indicator" [class.out-of-stock]="product.stock === 0">
                <div class="indicator-icon">
                  <mat-icon>{{ product.stock > 0 ? 'check_circle' : 'cancel' }}</mat-icon>
                </div>
                <span>{{ product.stock > 0 ? 'En stock' : 'Rupture' }}</span>
              </div>

              <!-- Badge de cat√©gorie -->
              <div class="category-badge">
                <span>{{ product.category?.name || 'Sans cat√©gorie' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Section Informations -->
      <div class="product-information">
        <!-- Header produit -->
        <div class="product-header">
          <div class="product-title-section">
            <h1 class="product-title">{{ product.name }}</h1>
            <div class="title-decoration"></div>
          </div>

          <div class="price-showcase">
            <div class="price-container">
              <span class="price-value">{{ product.price | currency:'XOF':'symbol':'1.0-0' }}</span>
              <div class="price-glow"></div>
            </div>
          </div>

          <div class="stock-details">
            <div class="stock-icon">
              <mat-icon [class]="product.stock > 0 ? 'text-success' : 'text-error'">
                {{ product.stock > 0 ? 'inventory' : 'inventory_2' }}
              </mat-icon>
            </div>
            <span class="stock-text" [class]="product.stock > 0 ? 'text-success' : 'text-error'">
              {{ product.stock > 0 ? product.stock + ' articles disponibles' : 'Produit indisponible' }}
            </span>
          </div>
        </div>

        <!-- Description -->
        <div class="product-description-card">
          <div class="description-header">
            <h3>Description du produit</h3>
            <div class="header-line"></div>
          </div>
          <div class="description-content">
            <p>{{ product.description }}</p>
          </div>
        </div>

        <!-- Section d'achat -->
        <div class="purchase-panel" *ngIf="product.stock > 0">
          <div class="panel-header">
            <h3>Commandez maintenant</h3>
            <div class="header-decoration"></div>
          </div>

          <div class="quantity-selector">
            <label class="quantity-label">Quantit√© souhait√©e</label>
            <div class="quantity-controls">
              <button class="quantity-button decrease" 
                      (click)="decreaseQuantity()"
                      [disabled]="quantity <= 1">
                <mat-icon>remove</mat-icon>
                <div class="button-ripple"></div>
              </button>
              
              <div class="quantity-display">
                <input type="number" 
                       [(ngModel)]="quantity"
                       [min]="1"
                       [max]="product.stock"
                       class="quantity-input"
                       readonly>
                <div class="input-glow"></div>
              </div>
              
              <button class="quantity-button increase" 
                      (click)="increaseQuantity(product.stock)"
                      [disabled]="quantity >= product.stock">
                <mat-icon>add</mat-icon>
                <div class="button-ripple"></div>
              </button>
            </div>
          </div>

          <div class="action-buttons">
            <button class="action-button primary-action"
                    (click)="addToCart(product)"
                    [disabled]="product.stock === 0">
              <span class="button-content">
                <mat-icon>add_shopping_cart</mat-icon>
                <span>Ajouter au panier</span>
              </span>
              <div class="button-glow"></div>
              <div class="button-particles"></div>
            </button>

            <button class="action-button secondary-action"
                    routerLink="/cart">
              <span class="button-content">
                <mat-icon>flash_on</mat-icon>
                <span>Acheter maintenant</span>
              </span>
              <div class="button-glow"></div>
            </button>
          </div>
        </div>

        <!-- Message rupture de stock -->
        <div class="out-of-stock-panel" *ngIf="product.stock === 0">
          <div class="panel-animation">
            <div class="warning-ring">
              <mat-icon class="warning-icon">inventory_2</mat-icon>
            </div>
          </div>
          <div class="panel-content">
            <h3>Produit indisponible</h3>
            <p>Ce produit est actuellement en rupture de stock. Revenez plus tard ou d√©couvrez nos autres produits.</p>
            <button class="explore-button" routerLink="/">
              <span class="button-content">
                <mat-icon>explore</mat-icon>
                <span>D√©couvrir d'autres produits</span>
              </span>
              <div class="button-glow"></div>
            </button>
          </div>
        </div>

        <!-- Caract√©ristiques premium -->
        <div class="features-showcase">
          <div class="features-header">
            <h3>Avantages premium</h3>
            <div class="header-decoration"></div>
          </div>
          
          <div class="features-grid">
            <div class="feature-card" style="--delay: 0s">
              <div class="feature-icon">
                <mat-icon>local_shipping</mat-icon>
                <div class="icon-glow"></div>
              </div>
              <div class="feature-content">
                <h4>Livraison express</h4>
                <p>Livraison sous 24-48h partout au S√©n√©gal</p>
              </div>
              <div class="card-glow"></div>
            </div>
            
            <div class="feature-card" style="--delay: 0.2s">
              <div class="feature-icon">
                <mat-icon>verified_user</mat-icon>
                <div class="icon-glow"></div>
              </div>
              <div class="feature-content">
                <h4>Garantie qualit√©</h4>
                <p>Produits authentiques et certifi√©s</p>
              </div>
              <div class="card-glow"></div>
            </div>
            
            <div class="feature-card" style="--delay: 0.4s">
              <div class="feature-icon">
                <mat-icon>support_agent</mat-icon>
                <div class="icon-glow"></div>
              </div>
              <div class="feature-content">
                <h4>Support premium</h4>
                <p>Assistance d√©di√©e 7j/7</p>
              </div>
              <div class="card-glow"></div>
            </div>
            
            <div class="feature-card" style="--delay: 0.6s">
              <div class="feature-icon">
                <mat-icon>payment</mat-icon>
                <div class="icon-glow"></div>
              </div>
              <div class="feature-content">
                <h4>Paiement s√©curis√©</h4>
                <p>Transactions 100% prot√©g√©es</p>
              </div>
              <div class="card-glow"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- √âl√©ments d√©coratifs flottants -->
  <div class="floating-elements">
    <div class="float-element element-1">üõçÔ∏è</div>
    <div class="float-element element-2">‚ú¶</div>
    <div class="float-element element-3">üíé</div>
    <div class="float-element element-4">‚óÜ</div>
    <div class="float-element element-5">‚≠ê</div>
  </div>
</div>